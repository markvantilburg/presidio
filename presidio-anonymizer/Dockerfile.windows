FROM python:3.12-windowsservercore-ltsc2022

ENV PIP_NO_CACHE_DIR=1
WORKDIR /app

COPY ./pyproject.toml /usr/bin/${NAME}/
COPY ./README.md /usr/bin/${NAME}/
COPY ./pyproject.toml /app/pyproject.toml
WORKDIR /Python
RUN python.exe -m pip install --upgrade pip
RUN python.exe -m pip install poetry; 
WORKDIR /app
RUN poetry install --no-root --only=main -E server
COPY . .

EXPOSE ${PORT}
CMD poetry run python app.py
